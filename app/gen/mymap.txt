const data = [{"id": 3327, "lat": 40.03, "lng": -83.14, "zip": "43026", "count": 1}, {"id": 3331, "lat": 32.26, "lng": -111.0, "zip": "85705", "count": 1}, {"id": 3332, "lat": 35.19, "lng": -80.83, "zip": "28211", "count": 1}, {"id": 3333, "lat": 38.68, "lng": -97.6, "zip": "67416", "count": 1}, {"id": 3334, "lat": 39.08, "lng": -84.7, "zip": "41048", "count": 1}, {"id": 3337, "lat": 39.09, "lng": -84.51, "zip": "45227", "count": 1}, {"id": 3339, "lat": 41.17, "lng": -81.43, "zip": "44224", "count": 1}, {"id": 3341, "lat": 40.16, "lng": -83.06, "zip": "43065", "count": 1}, {"id": 3342, "lat": 36.17, "lng": -86.78, "zip": "37209", "count": 1}, {"id": 3389, "lat": 42.44, "lng": -71.23, "zip": "02421", "count": 1}, {"id": 3343, "lat": 44.96, "lng": -93.26, "zip": "55405", "count": 1}, {"id": 3390, "lat": 39.16, "lng": -86.52, "zip": "47401", "count": 1}, {"id": 3344, "lat": 40.24, "lng": -75.28, "zip": "19446", "count": 1}, {"id": 3345, "lat": 39.98, "lng": -82.98, "zip": "43214", "count": 1}, {"id": 3356, "lat": 40.65, "lng": -84.95, "zip": "46711", "count": 3}, {"id": 3347, "lat": 42.32, "lng": -71.14, "zip": "02446", "count": 1}, {"id": 3348, "lat": 41.66, "lng": -83.58, "zip": "43620", "count": 1}, {"id": 3391, "lat": 44.16, "lng": -88.47, "zip": "54956", "count": 1}, {"id": 3392, "lat": 39.95, "lng": -75.16, "zip": "19125", "count": 1}, {"id": 3349, "lat": 42.27, "lng": -83.73, "zip": "48103", "count": 1}, {"id": 3350, "lat": 39.98, "lng": -82.98, "zip": "43224", "count": 1}, {"id": 3393, "lat": 43.06, "lng": -87.96, "zip": "53202", "count": 1}, {"id": 3351, "lat": 39.98, "lng": -82.98, "zip": "43230", "count": 1}, {"id": 3352, "lat": 34.13, "lng": -118.24, "zip": "91205", "count": 1}, {"id": 3353, "lat": 34.09, "lng": -81.18, "zip": "29063", "count": 1}, {"id": 3355, "lat": 34.16, "lng": -118.37, "zip": "91601", "count": 1}, {"id": 3357, "lat": 30.1, "lng": -95.29, "zip": "77365", "count": 1}, {"id": 3358, "lat": 33.39, "lng": -111.71, "zip": "85206", "count": 1}, {"id": 3336, "lat": 47.73, "lng": -122.34, "zip": "98133", "count": 2}, {"id": 3359, "lat": 41.07, "lng": -85.13, "zip": "46805", "count": 2}, {"id": 3360, "lat": 36.2, "lng": -79.17, "zip": "27231", "count": 1}, {"id": 3394, "lat": 40.12, "lng": -82.91, "zip": "43081", "count": 1}, {"id": 3361, "lat": 39.76, "lng": -104.87, "zip": "80229", "count": 1}, {"id": 3363, "lat": 44.96, "lng": -93.26, "zip": "55406", "count": 2}, {"id": 3364, "lat": 39.36, "lng": -82.13, "zip": "45780", "count": 1}, {"id": 3365, "lat": 40.81, "lng": -81.93, "zip": "44691", "count": 1}, {"id": 3366, "lat": 40.19, "lng": -85.39, "zip": "47304", "count": 1}, {"id": 3367, "lat": 29.45, "lng": -98.5, "zip": "78240", "count": 1}, {"id": 3369, "lat": 38.89, "lng": -77.03, "zip": "20009", "count": 1}, {"id": 3370, "lat": 39.98, "lng": -82.98, "zip": "43203", "count": 1}, {"id": 3395, "lat": 41.83, "lng": -87.68, "zip": "60654", "count": 1}, {"id": 3346, "lat": 40.11, "lng": -83.13, "zip": "43017", "count": 2}, {"id": 3371, "lat": 39.5, "lng": -84.37, "zip": "45044-1199", "count": 1}, {"id": 3335, "lat": 39.98, "lng": -82.98, "zip": "43205", "count": 3}, {"id": 3372, "lat": 39.95, "lng": -75.16, "zip": "19122", "count": 1}, {"id": 3328, "lat": 39.98, "lng": -82.98, "zip": "43221", "count": 4}, {"id": 3396, "lat": 47.67, "lng": -122.34, "zip": "98103", "count": 1}, {"id": 3373, "lat": 40.64, "lng": -73.94, "zip": "11221", "count": 1}, {"id": 3330, "lat": 39.98, "lng": -82.98, "zip": "43202", "count": 4}, {"id": 3397, "lat": 34.03, "lng": -118.49, "zip": "90403", "count": 1}, {"id": 3374, "lat": 38.95, "lng": -92.32, "zip": "65203", "count": 1}, {"id": 3398, "lat": 39.6, "lng": -82.82, "zip": "43154", "count": 1}, {"id": 3375, "lat": 39.98, "lng": -82.98, "zip": "43207", "count": 1}, {"id": 3338, "lat": 40.47, "lng": -88.97, "zip": "61701", "count": 2}, {"id": 3399, "lat": 41.09, "lng": -80.64, "zip": "44514", "count": 1}, {"id": 3376, "lat": 39.98, "lng": -82.98, "zip": "43229", "count": 1}, {"id": 3377, "lat": 40.74, "lng": -85.17, "zip": "46714", "count": 1}, {"id": 3378, "lat": 40.1, "lng": -83.27, "zip": "43064", "count": 1}, {"id": 3379, "lat": 39.98, "lng": -82.98, "zip": "43218-2437", "count": 1}, {"id": 3400, "lat": 39.98, "lng": -82.98, "zip": "43085", "count": 1}, {"id": 3380, "lat": 40.12, "lng": -82.91, "zip": "43082", "count": 2}, {"id": 3381, "lat": 25.68, "lng": -80.16, "zip": "33149", "count": 1}, {"id": 3382, "lat": 32.73, "lng": -117.03, "zip": "91945", "count": 1}, {"id": 3383, "lat": 41.08, "lng": -81.52, "zip": "44321", "count": 2}, {"id": 3384, "lat": 39.98, "lng": -82.98, "zip": "43209", "count": 1}, {"id": 3340, "lat": 39.98, "lng": -82.98, "zip": "43201", "count": 10}, {"id": 3385, "lat": 40.11, "lng": -83.13, "zip": "43016", "count": 1}, {"id": 3362, "lat": 40.0, "lng": -82.67, "zip": "43062", "count": 2}, {"id": 3402, "lat": 43.18, "lng": -89.23, "zip": "53590", "count": 1}, {"id": 3386, "lat": 34.02, "lng": -118.47, "zip": "90404", "count": 1}, {"id": 3387, "lat": 39.98, "lng": -82.98, "zip": "43232", "count": 1}, {"id": 3388, "lat": 45.52, "lng": -122.64, "zip": "97232", "count": 1}, {"id": 3403, "lat": 39.98, "lng": -82.98, "zip": "43201-3352", "count": 1}, {"id": 3404, "lat": 39.16, "lng": -86.52, "zip": "47404", "count": 1}, {"id": 3329, "lat": 39.98, "lng": -82.98, "zip": "43212", "count": 4}, {"id": 3406, "lat": 27.95, "lng": -82.48, "zip": "33617", "count": 1}, {"id": 3326, "lat": 39.98, "lng": -82.98, "zip": "43215", "count": 9}, {"id": 3368, "lat": 39.98, "lng": -82.98, "zip": "43206", "count": 5}, {"id": 3354, "lat": 40.29, "lng": -83.08, "zip": "43015", "count": 3}, {"id": 3407, "lat": 35.33, "lng": -96.91, "zip": "74804", "count": 1}, {"id": 3405, "lat": 39.77, "lng": -86.14, "zip": "46205", "count": 2}, {"id": 3408, "lat": 40.1, "lng": -88.2, "zip": "61802", "count": 1}, {"id": 3401, "lat": 39.09, "lng": -84.51, "zip": "45243", "count": 2}]
function getResponse(endpoint) {
  console.log("Getting Response")
  return fetch(endpoint)
      .then(function(response) {
        return response.json();
      });
}

function logLocations(locations) {
  console.log("logging.");
  // console.log(locations);
  for(var i = 0; i < locations.length; i++) {
    console.log(locations[i]['name']);
  }
}

function addMarkers(map, locations) {
  let myIcon = new L.divIcon({className: 'my-div-icon'});

  for(var i = 0; i < locations.length; i++) {
    let lng = locations[i]['lng'];
    let lat = locations[i]['lat'];
    console.log(lng, + " ", + lat);
    L.marker([lat, lng], {icon: myIcon}).addTo(map);
  }
}

function failureCallback(error) {
  console.log("Error getting locations: " + error);
}


function run() {
    let accessToken = "pk.eyJ1IjoiYmVubGVobWFuIiwiYSI6ImNqeHc2YThpMjBjZXIzYnFzcjczbnRqaWoifQ.lxxzkqRpnwBXpkvbOaKrpA"
    let mymap = new L.map('mapid').setView([37.09, -95.7129], 4);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(mymap);
    addMarkers(mymap, data)
}

if (document.readyState!='loading') run();

else if (document.addEventListener) document.addEventListener('DOMContentLoaded', run);

else document.attachEvent('onreadystatechange', function(){
    if (document.readyState=='complete') run();
});